<Activity mc:Ignorable="sap sap2010" x:Class="DB_Download" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="Folder_path" Type="InArgument(x:String)" />
    <x:Property Name="Arg_Status" Type="InArgument(x:Boolean)" />
    <x:Property Name="In_Config" Type="InArgument(scg:Dictionary(x:String, x:Object))" />
  </x:Members>
  <mva:VisualBasic.Settings>
    <x:Null />
  </mva:VisualBasic.Settings>
  <sap:VirtualizedContainerService.HintSize>1672,2888</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>DB_Download_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="36">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>System.Runtime.Serialization</x:String>
      <x:String>System.Activities.DynamicUpdate</x:String>
      <x:String>System.Reflection</x:String>
      <x:String>System.Runtime.InteropServices</x:String>
      <x:String>System.Security</x:String>
      <x:String>UiPath.Database</x:String>
      <x:String>UiPath.Database.Activities</x:String>
      <x:String>UiPath.Shared.Activities</x:String>
      <x:String>System.ComponentModel</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>UiPath.Excel</x:String>
      <x:String>UiPath.Excel.Activities</x:String>
      <x:String>UiPath.Platform.ResourceHandling</x:String>
      <x:String>Microsoft.VisualBasic.CompilerServices</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="68">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization</AssemblyReference>
      <AssemblyReference>System.Reflection.Metadata</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities.Design</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>Microsoft.Bcl.AsyncInterfaces</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>NPOI</AssemblyReference>
      <AssemblyReference>UiPath.Database</AssemblyReference>
      <AssemblyReference>UiPath.Database.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Mail.Activities</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationCore</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.Platform</AssemblyReference>
      <AssemblyReference>System.Runtime.WindowsRuntime</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <Sequence DisplayName="DB_Download" sap:VirtualizedContainerService.HintSize="1682,2823" sap2010:WorkflowViewState.IdRef="Sequence_1">
    <Sequence.Variables>
      <Variable x:TypeArguments="sd:DataTable" Name="Output" />
      <Variable x:TypeArguments="ui:DatabaseConnection" Name="RPACON" />
    </Sequence.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <TryCatch DisplayName="Try Catch" sap:VirtualizedContainerService.HintSize="1640,2731" sap2010:WorkflowViewState.IdRef="TryCatch_1">
      <TryCatch.Try>
        <Sequence sap:VirtualizedContainerService.HintSize="1602,2504" sap2010:WorkflowViewState.IdRef="Sequence_2">
          <Sequence.Variables>
            <Variable x:TypeArguments="x:Boolean" Name="Exist" />
            <Variable x:TypeArguments="x:String" Name="Timenow" />
          </Sequence.Variables>
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="1560,91" sap2010:WorkflowViewState.IdRef="LogMessage_1" Level="Info" Message="[&quot;Report Downloading Started&quot;]" />
          <ui:KillProcess AppliesTo="{x:Null}" Process="{x:Null}" ContinueOnError="True" DisplayName="Kill Process" sap:VirtualizedContainerService.HintSize="1560,51" sap2010:WorkflowViewState.IdRef="KillProcess_1" ProcessName="Excel">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </ui:KillProcess>
          <ui:PathExists Resource="{x:Null}" DisplayName="Path Exists" Exists="[Exist]" sap:VirtualizedContainerService.HintSize="1560,114" sap2010:WorkflowViewState.IdRef="PathExists_1" Path="[Folder_path+In_Config(&quot;Report&quot;).ToString]" PathType="File">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </ui:PathExists>
          <If Condition="[Exist=True]" sap:VirtualizedContainerService.HintSize="1560,460" sap2010:WorkflowViewState.IdRef="If_1">
            <If.Then>
              <Sequence sap:VirtualizedContainerService.HintSize="376,302" sap2010:WorkflowViewState.IdRef="Sequence_4">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:DeleteFileX DisplayName="Delete File" sap:VirtualizedContainerService.HintSize="334,79" sap2010:WorkflowViewState.IdRef="DeleteFileX_1" Path="[Folder_path+In_Config(&quot;Report&quot;).ToString]">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:DeleteFileX>
                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_3" Level="Info" Message="[&quot;Exist File Deleted&quot;]" />
              </Sequence>
            </If.Then>
            <If.Else>
              <Sequence sap:VirtualizedContainerService.HintSize="376,183" sap2010:WorkflowViewState.IdRef="Sequence_5">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_2" Level="Info" Message="[&quot;Exist File Does Not Found&quot;]" />
              </Sequence>
            </If.Else>
          </If>
          <ui:DatabaseConnect DisplayName="Connect to database" sap:VirtualizedContainerService.HintSize="1560,59" sap2010:WorkflowViewState.IdRef="DatabaseConnect_1" ProviderName="System.Data.Odbc" ConnectionString="Dsn=RPA_RO;uid=RPA_RO;pwd=Robot#123" DatabaseConnection="[RPACON]" />
          <Assign sap:VirtualizedContainerService.HintSize="1560,60" sap2010:WorkflowViewState.IdRef="Assign_1">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">[Timenow]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">[DateAndTime.Now.ToString("HH:mm")]</InArgument>
            </Assign.Value>
          </Assign>
          <If Condition="[Timenow&lt;&quot;12:30&quot;]" sap:VirtualizedContainerService.HintSize="1560,1044" sap2010:WorkflowViewState.IdRef="If_2">
            <If.Then>
              <Sequence sap:VirtualizedContainerService.HintSize="1039,886" sap2010:WorkflowViewState.IdRef="Sequence_6">
                <Sequence.Variables>
                  <Variable x:TypeArguments="x:String" Name="Today" />
                </Sequence.Variables>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <Assign sap:VirtualizedContainerService.HintSize="997,60" sap2010:WorkflowViewState.IdRef="Assign_4">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:String">[Today]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:String">[Date.Today.ToString("dd")]</InArgument>
                  </Assign.Value>
                </Assign>
                <If Condition="[Today=&quot;01&quot;]" sap:VirtualizedContainerService.HintSize="997,539" sap2010:WorkflowViewState.IdRef="If_3">
                  <If.Then>
                    <Sequence sap:VirtualizedContainerService.HintSize="476,381" sap2010:WorkflowViewState.IdRef="Sequence_10">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:DatabaseTransaction ContinueOnError="{x:Null}" DatabaseConnection="{x:Null}" DisplayName="Start Transaction" ExistingDbConnection="[RPACON]" sap:VirtualizedContainerService.HintSize="434,289" sap2010:WorkflowViewState.IdRef="DatabaseTransaction_1" UseTransaction="True">
                        <ui:DatabaseTransaction.Body>
                          <Sequence DisplayName="Previous MTD Report" sap:VirtualizedContainerService.HintSize="376,180" sap2010:WorkflowViewState.IdRef="Sequence_3">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ui:ExecuteQuery ContinueOnError="{x:Null}" CommandType="Text" DataTable="[Output]" DisplayName="Run query" ExistingDbConnection="[RPACON]" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_1" Sql="[&quot;select distinct t.loan_number, t.customer_name, t.kilometer, case when t.followup1 is null then 'N/A' when t.followup1 is not null then t.followup1 end as followup1, case when t.followup2 is null then 'N/A' when t.followup2 is not null then t.followup2 end as followup2, case when t.followup3 is null then 'N/A' when t.followup3 is not null then t.followup3 end as followup3, case when t.followup4 is null then 'N/A' when t.followup4 is not null then t.followup4 end as followup4, to_char(t.visit_date,'DD-MM-YYYY') as &quot;&quot;VISIT_DATE&quot;&quot;, to_char(t.proposed_clr_ovdue,'DD-MM-YYYY') as &quot;&quot;PROPOSED_CLEAR_OVERDUE&quot;&quot;, to_char(t.updateed_date,'DD-MM-YYYY HH24:MI:SS') as &quot;&quot;UPDATED_DATE&quot;&quot;, t.updated_by , e.emp_name, b.branch_name, m.state_name,p.post_name, 'Region '||r.region as &quot;&quot;REGION&quot;&quot;, case when t.remarks is null then 'nil' when t.remarks is not null then t.remarks end as remark,(case when tn.tra_dt is not null then to_char(tn.tra_dt,'DD-MM-YYYY') else to_char(emidt,'DD-MM-YYYY') end) as &quot;&quot;TRA_DATE&quot;&quot; , case when q.lstatus is null and w.gstatus is null then 'Paid' when q.lstatus is not null and w.gstatus is null then q.lstatus when q.lstatus is null and w.gstatus is not null then w.gstatus end as paid_status from mana0809.TBL_CUSTOMER_OVERDUE t left join mana0809.employee_master e on e.emp_code=t.updated_by left join mana0809.branch_master b on b.branch_id = e.branch_id left join mana0809.post_mst p on e.post_id=p.post_id left join mana0809.state_master m on m.state_id = b.state_id left join mana0809.tbl_spl_regions r on r.branch_id = b.branch_id left outer join (SELECT MAX(n.tra_dt) as tra_dt, n.Loan_Id from mana0809.TBL_NLOAN_LOAN_TRAN N WHERE (N.DESCR LIKE '%COLLECTED%' OR N.DESCR LIKE '%ACH%' OR N.DESCR LIKE '%PDC%') AND N.DESCR NOT LIKE '%RETURNED%' group by N.LOAN_ID) tn on t.loan_number=tn.Loan_Id left outer join (select distinct u.loan_id, (CASE WHEN u.newdpd&gt;=1 THEN 'Pending' ELSE null END) AS lstatus from mana0809.tbl_sma_classification_data_new u where u.department_id = '637' group by u.LOAN_ID,u.newdpd) q on t.loan_number=q.Loan_Id left outer join (select distinct v.loan_account_no, v.last_emi_adjustment_date as emidt, (CASE WHEN v.max_dpd&gt;=1 THEN 'Pending' ELSE null END) AS gstatus from mana0809.tw_npa_customerwise1 v group by v.loan_account_no,v.last_emi_adjustment_date,v.max_dpd) w on t.loan_number=w.loan_account_no where t.visit_date between add_months(trunc(sysdate, 'mm'), -1) And last_day(add_months(trunc(sysdate, 'mm'), -1))&quot;]" TimeoutMS="300000">
                              <ui:ExecuteQuery.Parameters>
                                <scg:Dictionary x:TypeArguments="x:String, Argument" />
                              </ui:ExecuteQuery.Parameters>
                            </ui:ExecuteQuery>
                          </Sequence>
                        </ui:DatabaseTransaction.Body>
                      </ui:DatabaseTransaction>
                    </Sequence>
                  </If.Then>
                  <If.Else>
                    <Sequence sap:VirtualizedContainerService.HintSize="476,381" sap2010:WorkflowViewState.IdRef="Sequence_11">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:DatabaseTransaction ContinueOnError="{x:Null}" DatabaseConnection="{x:Null}" DisplayName="Start Transaction" ExistingDbConnection="[RPACON]" sap:VirtualizedContainerService.HintSize="434,289" sap2010:WorkflowViewState.IdRef="DatabaseTransaction_3" UseTransaction="True">
                        <ui:DatabaseTransaction.Body>
                          <Sequence DisplayName="MTD Report" sap:VirtualizedContainerService.HintSize="376,180" sap2010:WorkflowViewState.IdRef="Sequence_12">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ui:ExecuteQuery ContinueOnError="{x:Null}" CommandType="Text" DataTable="[Output]" DisplayName="Run query" ExistingDbConnection="[RPACON]" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_3" Sql="[&quot;select distinct t.loan_number, t.customer_name, t.kilometer, case when t.followup1 is null then 'N/A' when t.followup1 is not null then t.followup1 end as followup1, case when t.followup2 is null then 'N/A' when t.followup2 is not null then t.followup2 end as followup2, case when t.followup3 is null then 'N/A' when t.followup3 is not null then t.followup3 end as followup3, case when t.followup4 is null then 'N/A' when t.followup4 is not null then t.followup4 end as followup4, to_char(t.visit_date,'DD-MM-YYYY') as &quot;&quot;VISIT_DATE&quot;&quot;, to_char(t.proposed_clr_ovdue,'DD-MM-YYYY') as &quot;&quot;PROPOSED_CLEAR_OVERDUE&quot;&quot;, to_char(t.updateed_date,'DD-MM-YYYY HH24:MI:SS') as &quot;&quot;UPDATED_DATE&quot;&quot;, t.updated_by , e.emp_name, b.branch_name, m.state_name,p.post_name, 'Region '||r.region as &quot;&quot;REGION&quot;&quot;, case when t.remarks is null then 'nil' when t.remarks is not null then t.remarks end as remark,(case when tn.tra_dt is not null then to_char(tn.tra_dt,'DD-MM-YYYY') else to_char(emidt,'DD-MM-YYYY') end) as &quot;&quot;TRA_DATE&quot;&quot; , case when q.lstatus is null and w.gstatus is null then 'Paid' when q.lstatus is not null and w.gstatus is null then q.lstatus when q.lstatus is null and w.gstatus is not null then w.gstatus end as paid_status from mana0809.TBL_CUSTOMER_OVERDUE t left join mana0809.employee_master e on e.emp_code=t.updated_by left join mana0809.branch_master b on b.branch_id = e.branch_id left join mana0809.state_master m on m.state_id = b.state_id left join mana0809.post_mst p on e.post_id=p.post_id left join mana0809.tbl_spl_regions r on r.branch_id = b.branch_id left outer join (SELECT MAX(n.tra_dt) as tra_dt, n.Loan_Id from mana0809.TBL_NLOAN_LOAN_TRAN N WHERE (N.DESCR LIKE '%COLLECTED%' OR N.DESCR LIKE '%ACH%' OR N.DESCR LIKE '%PDC%') AND N.DESCR NOT LIKE '%RETURNED%' group by N.LOAN_ID) tn on t.loan_number=tn.Loan_Id left outer join (select distinct u.loan_id, (CASE WHEN u.newdpd&gt;=1 THEN 'Pending' ELSE null END) AS lstatus from mana0809.tbl_sma_classification_data_new u where u.department_id = '637' group by u.LOAN_ID,u.newdpd) q on t.loan_number=q.Loan_Id left outer join (select distinct v.loan_account_no, v.last_emi_adjustment_date as emidt, (CASE WHEN v.max_dpd&gt;=1 THEN 'Pending' ELSE null END) AS gstatus from mana0809.tw_npa_customerwise1 v group by v.loan_account_no,v.last_emi_adjustment_date,v.max_dpd) w on t.loan_number=w.loan_account_no where t.visit_date &gt;= TRUNC(SYSDATE, 'MM') and t.visit_date &lt;= trunc(sysdate)-1&quot;]" TimeoutMS="300000">
                              <ui:ExecuteQuery.Parameters>
                                <scg:Dictionary x:TypeArguments="x:String, Argument" />
                              </ui:ExecuteQuery.Parameters>
                            </ui:ExecuteQuery>
                          </Sequence>
                        </ui:DatabaseTransaction.Body>
                      </ui:DatabaseTransaction>
                    </Sequence>
                  </If.Else>
                </If>
                <ui:WriteRange AddHeaders="True" DataTable="[Output]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="997,115" sap2010:WorkflowViewState.IdRef="WriteRange_1" SheetName="MTD Report" WorkbookPath="[Folder_path+In_Config(&quot;Report&quot;).ToString]">
                  <ui:WriteRange.StartingCell>
                    <InArgument x:TypeArguments="x:String">
                      <Literal x:TypeArguments="x:String" Value="" />
                    </InArgument>
                  </ui:WriteRange.StartingCell>
                </ui:WriteRange>
              </Sequence>
            </If.Then>
            <If.Else>
              <Sequence sap:VirtualizedContainerService.HintSize="476,536" sap2010:WorkflowViewState.IdRef="Sequence_7">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:DatabaseTransaction ContinueOnError="{x:Null}" DatabaseConnection="{x:Null}" DisplayName="Start Transaction" ExistingDbConnection="[RPACON]" sap:VirtualizedContainerService.HintSize="434,289" sap2010:WorkflowViewState.IdRef="DatabaseTransaction_2" UseTransaction="True">
                  <ui:DatabaseTransaction.Body>
                    <Sequence DisplayName="Today Report" sap:VirtualizedContainerService.HintSize="376,180" sap2010:WorkflowViewState.IdRef="Sequence_8">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:ExecuteQuery ContinueOnError="{x:Null}" CommandType="Text" DataTable="[Output]" DisplayName="Run query" ExistingDbConnection="[RPACON]" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_2" Sql="[&quot;select distinct t.loan_number, t.customer_name, t.kilometer, case when t.followup1 is null then 'N/A' when t.followup1 is not null then t.followup1 end as followup1, case when t.followup2 is null then 'N/A' when t.followup2 is not null then t.followup2 end as followup2, case when t.followup3 is null then 'N/A' when t.followup3 is not null then t.followup3 end as followup3, case when t.followup4 is null then 'N/A' when t.followup4 is not null then t.followup4 end as followup4, to_char(t.visit_date,'DD-MM-YYYY') as &quot;&quot;VISIT_DATE&quot;&quot;, to_char(t.proposed_clr_ovdue,'DD-MM-YYYY') as &quot;&quot;PROPOSED_CLEAR_OVERDUE&quot;&quot;, to_char(t.updateed_date,'DD-MM-YYYY HH24:MI:SS') as &quot;&quot;UPDATED_DATE&quot;&quot;, t.updated_by , e.emp_name, b.branch_name, m.state_name,p.post_name, 'Region '||r.region as &quot;&quot;REGION&quot;&quot;, case when t.remarks is null then 'nil' when t.remarks is not null then t.remarks end as remark,(case when tn.tra_dt is not null then to_char(tn.tra_dt,'DD-MM-YYYY') else to_char(emidt,'DD-MM-YYYY') end) as &quot;&quot;TRA_DATE&quot;&quot; , case when q.lstatus is null and w.gstatus is null then 'Paid' when q.lstatus is not null and w.gstatus is null then q.lstatus when q.lstatus is null and w.gstatus is not null then w.gstatus end as paid_status from mana0809.TBL_CUSTOMER_OVERDUE t left join mana0809.employee_master e on e.emp_code=t.updated_by left join mana0809.branch_master b on b.branch_id = e.branch_id left join mana0809.state_master m on m.state_id = b.state_id left join mana0809.post_mst p on e.post_id=p.post_id left join mana0809.tbl_spl_regions r on r.branch_id = b.branch_id left outer join (SELECT MAX(n.tra_dt) as tra_dt, n.Loan_Id from mana0809.TBL_NLOAN_LOAN_TRAN N WHERE (N.DESCR LIKE '%COLLECTED%' OR N.DESCR LIKE '%ACH%' OR N.DESCR LIKE '%PDC%') AND N.DESCR NOT LIKE '%RETURNED%' group by N.LOAN_ID) tn on t.loan_number=tn.Loan_Id left outer join (select distinct u.loan_id, (CASE WHEN u.newdpd&gt;=1 THEN 'Pending' ELSE null END) AS lstatus from mana0809.tbl_sma_classification_data_new u where u.department_id = '637' group by u.LOAN_ID,u.newdpd) q on t.loan_number=q.Loan_Id left outer join (select distinct v.loan_account_no, v.last_emi_adjustment_date as emidt, (CASE WHEN v.max_dpd&gt;=1 THEN 'Pending' ELSE null END) AS gstatus from mana0809.tw_npa_customerwise1 v group by v.loan_account_no,v.last_emi_adjustment_date,v.max_dpd) w on t.loan_number=w.loan_account_no where t.visit_date = trunc(sysdate)&quot;]" TimeoutMS="300000">
                        <ui:ExecuteQuery.Parameters>
                          <scg:Dictionary x:TypeArguments="x:String, Argument" />
                        </ui:ExecuteQuery.Parameters>
                      </ui:ExecuteQuery>
                    </Sequence>
                  </ui:DatabaseTransaction.Body>
                </ui:DatabaseTransaction>
                <ui:WriteRange AddHeaders="True" DataTable="[Output]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="434,115" sap2010:WorkflowViewState.IdRef="WriteRange_2" SheetName="Today Report" WorkbookPath="[Folder_path+In_Config(&quot;Report&quot;).ToString]">
                  <ui:WriteRange.StartingCell>
                    <InArgument x:TypeArguments="x:String">
                      <Literal x:TypeArguments="x:String" Value="" />
                    </InArgument>
                  </ui:WriteRange.StartingCell>
                </ui:WriteRange>
              </Sequence>
            </If.Else>
          </If>
          <ui:DatabaseDisconnect DatabaseConnection="[RPACON]" DisplayName="Disconnect from database" sap:VirtualizedContainerService.HintSize="1560,22" sap2010:WorkflowViewState.IdRef="DatabaseDisconnect_1" />
          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="1560,91" sap2010:WorkflowViewState.IdRef="LogMessage_4" Level="Info" Message="[&quot;Report Downloading Completed&quot;]" />
          <Assign sap:VirtualizedContainerService.HintSize="1560,60" sap2010:WorkflowViewState.IdRef="Assign_2">
            <Assign.To>
              <OutArgument x:TypeArguments="x:Boolean">[Arg_Status]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:Boolean">True</InArgument>
            </Assign.Value>
          </Assign>
        </Sequence>
      </TryCatch.Try>
      <TryCatch.Catches>
        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="1606,21" sap2010:WorkflowViewState.IdRef="Catch`1_1">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <ActivityAction x:TypeArguments="s:Exception">
            <ActivityAction.Argument>
              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
            </ActivityAction.Argument>
            <Sequence sap:VirtualizedContainerService.HintSize="376,283" sap2010:WorkflowViewState.IdRef="Sequence_9">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_5" Level="Error" Message="[exception.Message]" />
              <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_3">
                <Assign.To>
                  <OutArgument x:TypeArguments="x:Boolean">[Arg_Status]</OutArgument>
                </Assign.To>
                <Assign.Value>
                  <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                </Assign.Value>
              </Assign>
            </Sequence>
          </ActivityAction>
        </Catch>
      </TryCatch.Catches>
    </TryCatch>
  </Sequence>
</Activity>